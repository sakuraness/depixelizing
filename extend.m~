function ex = extend(input)

[r, l, h] = size(input);

ex(1, 1, :) = input(1, 1, :);
ex(1, 2:(l+1), :) = input(1, :, :);
ex(1, (l+2), :) = input(1, l, :);
ex(2, :, :) = extend(1, :, :);

for i = 1:r
    ex((2+i), 1, :) = input(i, 1, :);
    ex((2+i), 2:(l+1), :) = input(i, :, :);
    ex((2+i), (l+2), :) = input(i, l, :);
end

ex((r+3), 1, :) = input(r, 1, :);
ex((r+3), 2:(l+1), :) = input(r, :, :);
ex((r+3), (l+2), :) = input(r, l, :);
ex((r+4), :, :) = extend((r+3), :, :);

end

